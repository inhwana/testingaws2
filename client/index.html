<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!-- <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script> -->

</head>
<body>
    <label for="video">Upload Video:</label><br><br>
    <input type="file" id="video" accept="video/*"><br><br>
    <button onclick="uploadvideo()">Upload</button>
    <h2 id="status"></h2>
    

    <script>
        async function uploadvideo(){
            const videofile = document.getElementById("video")
            const video = videofile.files[0]
            if (!video) return alert("Please upload a video")

            const res = await fetch('/upload', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                //body:JSON.stringify({filename: video.name})
                body:JSON.stringify({filename: video.name, contentType: video.type})
            })

            const {url: presignedURL} = await res.json()
    
            
            
            //bugufixingwithaxios
            // try {
            //     await axios.put(presignedURL, video, {
            //         headers: {
            //         'Content-Type': video.type
            //         }
            //     });
            //     document.getElementById('status').textContent = "✅ Upload Complete";
            //     } catch (err) {
            //     console.error("Upload error:", err);
            //     document.getElementById('status').textContent = "❌ Upload Failed";
            //     }
                        
                       
            
            
            // fetching the object using an HTTP request to the URL.
            const uploads3 = await fetch(presignedURL, { 
                method: "PUT", 
                headers: {'Content-Type':video.type},
                body: video
            });
            // if (uploads3.ok) {
            //     alert("✅ Video uploaded successfully!");
            // } else {
            //     alert("❌ Upload failed.");
            // }
            document.getElementById('status').textcontent = uploads3.ok ? "Upload Complete":"Upload Fail" 

        }
    </script>
    <!-- <script src="script.js" defer></script> -->
</body>
</html>